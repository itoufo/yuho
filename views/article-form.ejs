<%- include('layout', { body: `

<h1>${article ? '記事を編集' : '新規記事'}</h1>

<div class="card">
  <form method="POST" action="${article ? '/articles/' + article.id : '/articles'}">
    <div class="form-group">
      <label>タイトル *</label>
      <input type="text" name="title" value="${article ? article.title : ''}" required>
    </div>

    <div class="grid grid-2">
      <div class="form-group">
        <label>ブランディング</label>
        <select name="branding_type">
          <option value="">選択してください</option>
          ${branding.map(b => `
            <option value="${b.code}" ${article && article.branding_type === b.code ? 'selected' : ''}>${b.name}</option>
          `).join('')}
        </select>
      </div>

      <div class="form-group">
        <label>カテゴリ</label>
        <input type="text" name="category" value="${article ? article.category || '' : ''}" list="categories" placeholder="例: 自己紹介, 失敗談, 成長力学">
        <datalist id="categories">
          ${categories.map(c => `<option value="${c.category}">`).join('')}
        </datalist>
      </div>
    </div>

    <div class="grid grid-2">
      <div class="form-group">
        <label>ステータス</label>
        <select name="status">
          <option value="idea" ${!article || article.status === 'idea' ? 'selected' : ''}>アイデア</option>
          <option value="drafting" ${article && article.status === 'drafting' ? 'selected' : ''}>執筆中</option>
          <option value="review" ${article && article.status === 'review' ? 'selected' : ''}>レビュー</option>
          <option value="published" ${article && article.status === 'published' ? 'selected' : ''}>公開済み</option>
        </select>
      </div>

      <div class="form-group">
        <label>優先度 (0-10)</label>
        <input type="number" name="priority" value="${article ? article.priority : 0}" min="0" max="10">
      </div>
    </div>

    <div class="form-group">
      <label>ファイルパス</label>
      <input type="text" name="file_path" value="${article ? article.file_path || '' : ''}" placeholder="例: drafts/my-article.md">
    </div>

    ${article ? `
      <div class="form-group">
        <label>note.com URL</label>
        <input type="url" name="note_url" value="${article.note_url || ''}" placeholder="https://note.com/...">
      </div>
    ` : ''}

    <div class="actions" style="margin-top: 20px;">
      <button type="submit" class="btn btn-primary">${article ? '更新' : '作成'}</button>
      <a href="/articles" class="btn btn-secondary">キャンセル</a>
      ${article ? `
        <form method="POST" action="/articles/${article.id}/delete" style="margin-left: auto;" onsubmit="return confirm('本当に削除しますか？')">
          <button type="submit" class="btn btn-danger">削除</button>
        </form>
      ` : ''}
    </div>
  </form>
</div>

` }) %>
